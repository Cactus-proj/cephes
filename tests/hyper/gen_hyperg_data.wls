(* gen_hyperg_data.wls *)
(* This script generates test data for the Confluent Hypergeometric function 1F1(a, b, x) *)
(* and exports it to a C++ header file. *)

(* Parameter Ranges *)
aVals = Range[-5.0, 5.0, 0.5];
bVals = {0.5, 1.0, 1.5, 2.0, 3.0, 3.5, 4.0, 5.0};
xVals = {0.1, 1.0, 5.0, 10.0, 20.0, 30.0};

outputFile = "hyperg_data.h";

(* Helper to format numbers for C++ *)
fmt[num_] := ToString[CForm[N[num]]];
fmtRes[num_] := ToString[CForm[N[num, 17]]]; (* High precision for result *)

st = OpenWrite[outputFile];

WriteString[st, "// Generated by gen_hyperg_data.wls\n"];
WriteString[st, "// Test data for Confluent Hypergeometric function 1F1(a, b, x)\n"];
WriteString[st, "#pragma once\n\n"];

WriteString[st, "struct HypergTestCase {\n"];
WriteString[st, "    double a;\n"];
WriteString[st, "    double b;\n"];
WriteString[st, "    double x;\n"];
WriteString[st, "    double expected;\n"];
WriteString[st, "};\n\n"];

WriteString[st, "static const HypergTestCase hyperg_data[] = {\n"];

(* Loop over x, then a, then b to organize by x as requested *)
Do[
  (* Calculate 1F1 *)
  (* Note: Wolfram's Hypergeometric1F1 is the confluent hypergeometric function *)
  y = Hypergeometric1F1[a, b, x];
  
  (* Write row *)
  (* Check for Indeterminate or ComplexInfinity *)
  If[NumberQ[N[y]] && !MatchQ[N[y], Indeterminate | ComplexInfinity],
      WriteString[st, 
        "    {", fmt[a], ", ", fmt[b], ", ", fmt[x], ", ", fmtRes[y], "},\n"
      ];
  ];
  , {x, xVals}, {a, aVals}, {b, bVals}
];

WriteString[st, "};\n"];
Close[st];
